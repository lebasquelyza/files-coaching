<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="noindex, nofollow" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <title>Files Coaching ‚Äî Questionnaire</title>
  <style>
    :root{
      /* Vert de l‚Äôappli d√©tect√© dans ta page */
      --app-green:#16a34a;   /* vert principal */
      --app-green-dark:#15803d; /* nuance plus sombre */

      --bg:#ffffff;--text:#111111;--muted:#374151;--panel:#ffffff;--line:#e5e7eb;
      --brand:var(--app-green);
      --brand2:var(--app-green-dark);
      --accent:#0ea5e9;--radius:14px;--shadow:0 6px 18px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;background:var(--bg);color:var(--text);line-height:1.6}
    .topbar{position:sticky;top:0;z-index:50;backdrop-filter:blur(6px);background:#fffffff2;border-bottom:1px solid var(--line)}
    .topbar-inner{max-width:1100px;margin:0 auto;padding:12px 16px;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;color:#0b0f14}
    /* Carr√© vert sans emoji */
    .brand .logo{
      width:36px;height:36px;border-radius:10px;display:block;
      background:linear-gradient(135deg,var(--brand),var(--brand2));
      box-shadow:0 4px 10px rgba(22,163,74,.25);
    }
    .top-actions a{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;text-decoration:none;
      color:#111;border-radius:10px;border:1px solid var(--line);background:#fff;font-weight:700;box-shadow:var(--shadow)}
    .top-actions a:hover{background:#f8fafc}
    .wrap{max-width:980px;margin:24px auto;padding:20px}
    .card{width:100%;background:var(--panel);border:1px solid var(--line);border-radius:20px;padding:24px;box-shadow:var(--shadow)}
    .title{margin:0 0 8px;font-size:clamp(22px,3vw,30px);color:#0b0f14}
    .subtitle{margin:0 0 18px;color:#0b0f14}
    .steps{display:grid;gap:10px;margin:16px 0 20px}
    .step{display:flex;gap:10px;align-items:baseline;padding:10px 12px;border:1px dashed var(--line);border-radius:12px;color:#111}
    .step b{min-width:95px}
    form{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    form .full{grid-column:1 / -1}
    label{display:block;font-weight:600;font-size:14px;margin:4px 0 6px;color:#0b0f14}
    input,select,textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid var(--line);
      background:#fff;color:#111;outline:none;transition:border-color .2s, box-shadow .2s}
    input::placeholder,textarea::placeholder{color:#9ca3af}
    input:focus,select:focus,textarea:focus{border-color:var(--brand);box-shadow:0 0 0 3px rgba(22,163,74,.15)}
    textarea{min-height:120px;resize:vertical}
    .btn{appearance:none;border:none;background:linear-gradient(135deg,var(--brand),#22c55e);color:#fff;
      padding:12px 18px;border-radius:12px;font-weight:800;cursor:pointer;box-shadow:var(--shadow)}
    .btn.ghost{background:#fff;border:1px solid var(--line);color:#111}
    .btn:disabled{opacity:.7;cursor:not-allowed}
    .msg{grid-column:1/-1;font-size:14px;color:#b91c1c;display:none}
    .hero{min-height:calc(100dvh - 64px);display:grid;place-items:center;background:var(--bg)}
    .center{text-align:center}
    [hidden]{display:none !important}
    a{color:var(--brand);text-decoration:none} a:hover{text-decoration:underline}
    @media (max-width:720px){form{grid-template-columns:1fr}.step b{min-width:auto}.top-actions a{padding:8px 12px}}
  </style>
</head>
<body>

  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        Files Coaching
      </div>
      <div class="top-actions">
        <a href="mailto:sportifandpro@gmail.com">‚úâÔ∏è Nous contacter</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section id="formulaire" class="hero">
      <div class="card">
        <h2 class="title">Questionnaire coaching</h2>
        <p class="subtitle">Remplis ce formulaire. <b>Files</b> √©tudie tes r√©ponses pour b√¢tir ton programme.</p>

        <div class="steps">
          <div class="step"><b>1 ¬∑ Infos</b><span>Pr√©sente toi</span></div>
          <div class="step"><b>2 ¬∑ Objectif</b><span>Fixe tes objectifs</span></div>
          <div class="step"><b>3 ¬∑ Plan</b><span>Tu re√ßois ton programme</span></div>
        </div>

        <!-- Formulaire -->
        <form
          id="coaching-form"
          name="coaching"
          method="POST"
          data-netlify="true"
          netlify-honeypot="bot-field"
          action="/?merci=1">
          <input type="hidden" name="form-name" value="coaching" />
          <input type="hidden" name="bot-field" />

          <div>
            <label for="prenom">Pr√©nom</label>
            <input id="prenom" name="prenom" placeholder="Ex. Files" required />
          </div>
          <div>
            <label for="age">√Çge</label>
            <input id="age" name="age" type="number" inputmode="numeric"
                   min="10" max="100" placeholder="Ex. 25" required />
          </div>
          <div>
            <label for="poids">Poids (kg)</label>
            <input id="poids" name="poids" type="number" step="0.1" min="20" max="400" placeholder="Ex. 60" required />
          </div>
          <div>
            <label for="taille">Taille (cm)</label>
            <input id="taille" name="taille" type="number" min="100" max="250" placeholder="Ex. 170" />
          </div>
          <div>
            <label for="niveau">Niveau</label>
            <select id="niveau" name="niveau" required>
              <option value="" disabled selected>Choisir un niveau‚Ä¶</option>
              <option value="faible">Faible</option>
              <option value="modere">Mod√©r√©</option>
              <option value="pro">Pro</option>
            </select>
          </div>
          <div class="full">
            <label for="objectif">Objectif</label>
            <input id="objectif" name="objectif" placeholder="Ex. Perte de poids" required />
          </div>
          <div class="full">
            <label for="dispo">Disponibilit√©s</label>
            <textarea id="dispo" name="dispo" placeholder="Ex : Lundi & Jeudi soir ; Samedi matin ; 3 s√©ances/sem."></textarea>
          </div>

          <div class="full">
            <label for="lieu">√Ä quel endroit vas-tu faire ta s√©ance ?</label>
            <input id="lieu" name="lieu" placeholder="Ex. Maison, salle de sport, parc‚Ä¶" required />
          </div>

          <!-- Champ "mat√©riel" supprim√© -->

          <div class="full">
            <label for="email">Adresse e-mail</label>
            <input id="email" name="email" type="email" placeholder="exemple@mail.com" required />
          </div>

          <p id="msg" class="msg">Oups, envoi impossible. R√©essaie dans un instant.</p>

          <div class="full" style="text-align:right;margin-top:6px">
            <button class="btn" type="submit" id="submit-btn">Envoyer & recevoir l‚Äôe-mail</button>
          </div>
        </form>
      </div>
    </section>

    <section id="thanks" class="hero" hidden>
      <div class="card center">
        <h2 class="title">Merci üéâ</h2>
        <p class="subtitle">Merci pour ta r√©ponse ! Files se charge de les examiner et de revenir vers toi avec un programme adapt√© !</p>
        <div style="margin-top:18px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
          <a class="btn ghost" href="https://appli.files-coaching.com/dashboard/profile">Aller vers mes s√©ances</a>
        </div>
      </div>
    </section>
  </main>

  <script>
    const FUNCTION_URL = '/.netlify/functions/send-confirmation';
    const GOOGLE_SHEET_URL = 'https://script.google.com/macros/s/AKfycbzOAJDQLcxthm2omIwgueWcZ-3uXJYmk5J6njmg5Ux7exX4lb90tbATgKXGQ_HnWzdgyw/exec';

    const form = document.getElementById('coaching-form');
    const btn = document.getElementById('submit-btn');
    const msg = document.getElementById('msg');
    const formSection = document.getElementById('formulaire');
    const thanksSection = document.getElementById('thanks');

    (function () {
      const u = new URL(location.href);
      if (u.searchParams.get('merci') === '1') showThanks();
    })();

    const encode = (data) => Object.keys(data)
      .map(k => encodeURIComponent(k) + '=' + encodeURIComponent(data[k] ?? ''))
      .join('&');

    function showThanks() {
      formSection.hidden = true;
      thanksSection.hidden = false;
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.style.display = 'none';

      const data = Object.fromEntries(new FormData(form).entries());
      if (data['bot-field']) return;

      if (!data.email || !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(data.email)) {
        msg.textContent = 'Entre une adresse e-mail valide üôÇ';
        msg.style.display = 'block';
        return;
      }

      const saved = btn.textContent;
      btn.disabled = true; btn.textContent = 'Envoi‚Ä¶';

      try {
        // 1) Email via fonction Netlify
        await fetch(FUNCTION_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        });

        // 2) Netlify Forms (non-bloquant)
        try {
          await fetch(form.getAttribute('action') || '/', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: encode({ 'form-name': form.getAttribute('name') || 'coaching', ...data }),
          });
        } catch (e2) {}

        // 3) Google Sheets via Apps Script (non-bloquant aussi)
        try {
          await fetch(GOOGLE_SHEET_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: encode(data),
          });
        } catch (e3) {}

        // 4) Affiche "merci"
        form.reset();
        showThanks();
      } catch (err) {
        msg.textContent = "Oups‚Ä¶ impossible d‚Äôenvoyer. " + String(err?.message || "");
        msg.style.display = 'block';
      } finally {
        btn.disabled = false; btn.textContent = saved;
      }
    });
  </script>
</body>
</html>
